{"version":3,"sources":["spinner.js","../src/spinner.ts"],"names":["__decorate","decorators","target","key","desc","c","arguments","length","r","Object","getOwnPropertyDescriptor","d","Reflect","decorate","i","defineProperty","exports","value","aurelia_framework_1","require","aurelia_pal_1","spinner_config_1","SpinnerCustomAttribute","element","container","viewEngine","spinnerConfig","spinnerHtml","PLATFORM","moduleName","show","view","undefined","block","config","assign","SpinnerCustomAttribute_1","defaultConfig","prototype","bind","spinner","useBackgroundBlocker","Error","attached","createSpinner","showChanged","showSpinner","classList","add","blockerClass","remove","_this","loadViewFactory","then","factory","childContainer","createChild","create","addElement","removeSpinner","document","querySelectorAll","id","removeChild","divElement","spinnerDivElement","createElement","appendNodesTo","children","firstElementChild","setElementStyle","appendChild","htmlElement","style","position","zIndex","top","left","bindable","defaultBindingMode","bindingMode","oneWay","oneTime","inject","Element","Container","ViewEngine"],"mappings":"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","file":"spinner.js","sourceRoot":"/source/","sourcesContent":["\"use strict\";\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar aurelia_framework_1 = require(\"aurelia-framework\");\nvar aurelia_pal_1 = require(\"aurelia-pal\");\nvar spinner_config_1 = require(\"./spinner-config\");\nvar SpinnerCustomAttribute = (function () {\n    function SpinnerCustomAttribute(element, container, viewEngine, spinnerConfig) {\n        this.element = element;\n        this.container = container;\n        this.viewEngine = viewEngine;\n        this.spinnerConfig = spinnerConfig;\n        this.spinnerHtml = aurelia_pal_1.PLATFORM.moduleName('aurelia-spinner/dist/spinner.html');\n        this.show = false;\n        this.view = undefined;\n        this.block = undefined;\n        if (spinnerConfig)\n            this.config = Object.assign({}, SpinnerCustomAttribute_1.defaultConfig, this.spinnerConfig);\n    }\n    SpinnerCustomAttribute_1 = SpinnerCustomAttribute;\n    SpinnerCustomAttribute.prototype.bind = function () {\n        this.view = this.view || this.config.spinner;\n        this.block = this.block === undefined ? this.config.useBackgroundBlocker : this.block;\n        if (!this.view)\n            throw new Error(\"no view has been specified for the spinner\");\n    };\n    SpinnerCustomAttribute.prototype.attached = function () {\n        this.createSpinner();\n    };\n    SpinnerCustomAttribute.prototype.showChanged = function (showSpinner) {\n        if (!this.target && !this.block)\n            return;\n        showSpinner ? this.target.classList.add(this.config.blockerClass) :\n            this.target.classList.remove(this.config.blockerClass);\n    };\n    SpinnerCustomAttribute.prototype.createSpinner = function () {\n        var _this = this;\n        this.viewEngine.loadViewFactory(this.spinnerHtml).then(function (factory) {\n            var childContainer = _this.container.createChild();\n            var view = factory.create(childContainer);\n            view.bind(_this);\n            _this.addElement(view);\n        });\n    };\n    SpinnerCustomAttribute.prototype.removeSpinner = function () {\n        var removeSpinner = document.querySelectorAll(\"#\" + this.element.id)[0];\n        removeSpinner.removeChild(this.divElement);\n    };\n    SpinnerCustomAttribute.prototype.addElement = function (view) {\n        var container = document.querySelectorAll(\"#\" + this.element.id)[0];\n        var spinnerDivElement = document.createElement('div');\n        view.appendNodesTo(spinnerDivElement);\n        this.target = this.element.children.length === 1 ? this.element.firstElementChild : this.element;\n        this.divElement = this.setElementStyle(this.element, spinnerDivElement);\n        if (this.block)\n            this.target.classList.add(this.config.blockerClass);\n        //todo check si es custom element o como para decirdir hacer eso o\n        //container.insertBefore(this.divElement, container.firstChild););\n        container.firstElementChild.appendChild(this.divElement);\n    };\n    // todo fix too recalculate element height\n    SpinnerCustomAttribute.prototype.setElementStyle = function (element, htmlElement) {\n        element.style.position = 'relative';\n        htmlElement.style.position = 'absolute';\n        htmlElement.style.zIndex = '999';\n        htmlElement.style.top = 'calc(50% - 65px)';\n        htmlElement.style.left = 'calc(50% - 35px)';\n        return htmlElement;\n    };\n    SpinnerCustomAttribute.defaultConfig = {\n        spinner: undefined,\n        useBackgroundBlocker: false,\n        blockerClass: spinner_config_1.blockerClass\n    };\n    __decorate([\n        aurelia_framework_1.bindable({ defaultBindingMode: aurelia_framework_1.bindingMode.oneWay })\n    ], SpinnerCustomAttribute.prototype, \"show\", void 0);\n    __decorate([\n        aurelia_framework_1.bindable({ defaultBindingMode: aurelia_framework_1.bindingMode.oneTime })\n    ], SpinnerCustomAttribute.prototype, \"view\", void 0);\n    __decorate([\n        aurelia_framework_1.bindable({ defaultBindingMode: aurelia_framework_1.bindingMode.oneTime })\n    ], SpinnerCustomAttribute.prototype, \"block\", void 0);\n    SpinnerCustomAttribute = SpinnerCustomAttribute_1 = __decorate([\n        aurelia_framework_1.inject(Element, aurelia_framework_1.Container, aurelia_framework_1.ViewEngine, 'spinner-config')\n    ], SpinnerCustomAttribute);\n    return SpinnerCustomAttribute;\n    var SpinnerCustomAttribute_1;\n}());\nexports.SpinnerCustomAttribute = SpinnerCustomAttribute;\n","import { inject, bindable, bindingMode, Container, View, ViewEngine } from 'aurelia-framework';\r\nimport { PLATFORM } from 'aurelia-pal';\r\n\r\nimport { SpinnerConfig, spinnerViews, blockerClass } from \"./spinner-config\";\r\n\r\n@inject(Element, Container, ViewEngine, 'spinner-config')\r\nexport class SpinnerCustomAttribute {\r\n  private divElement: HTMLElement;\r\n  private target: Element;\r\n  private readonly spinnerHtml: string = PLATFORM.moduleName('aurelia-spinner/dist/spinner.html');\r\n  private config: SpinnerConfig;\r\n\r\n  @bindable({ defaultBindingMode: bindingMode.oneWay }) show: boolean = false;\r\n  @bindable({ defaultBindingMode: bindingMode.oneTime }) view: string = undefined;\r\n  @bindable({ defaultBindingMode: bindingMode.oneTime }) block: boolean = undefined;\r\n\r\n  static defaultConfig: SpinnerConfig = {\r\n    spinner: undefined,\r\n    useBackgroundBlocker: false,\r\n    blockerClass: blockerClass\r\n  };\r\n\r\n  constructor(private element: Element,\r\n    private container: Container,\r\n    private viewEngine: ViewEngine,\r\n    private spinnerConfig: SpinnerConfig) {\r\n    if (spinnerConfig) this.config = Object.assign({}, SpinnerCustomAttribute.defaultConfig, this.spinnerConfig);\r\n  }\r\n\r\n  bind() {\r\n    this.view = this.view || this.config.spinner;\r\n    this.block = this.block === undefined ? this.config.useBackgroundBlocker : this.block;\r\n    \r\n    if (!this.view) throw new Error(\"no view has been specified for the spinner\");\r\n  }\r\n\r\n  attached() {\r\n    this.createSpinner();\r\n  }\r\n\r\n  showChanged(showSpinner: boolean) {\r\n    if (!this.target && !this.block) return;\r\n\r\n    showSpinner ? this.target.classList.add(this.config.blockerClass) :\r\n      this.target.classList.remove(this.config.blockerClass);\r\n  }\r\n\r\n  private createSpinner(): void {\r\n    this.viewEngine.loadViewFactory(this.spinnerHtml).then(factory => {\r\n      const childContainer = this.container.createChild();\r\n      const view = factory.create(childContainer);\r\n      view.bind(this);\r\n\r\n      this.addElement(view);\r\n    });\r\n  }\r\n\r\n  private removeSpinner(): void {\r\n    const removeSpinner = document.querySelectorAll(`#${this.element.id}`)[0];\r\n    removeSpinner.removeChild(this.divElement);\r\n  }\r\n\r\n  private addElement(view: View): void {\r\n    const container = document.querySelectorAll(`#${this.element.id}`)[0];\r\n    const spinnerDivElement = <HTMLElement>document.createElement('div');\r\n\r\n    view.appendNodesTo(spinnerDivElement);\r\n\r\n    this.target = this.element.children.length === 1 ? this.element.firstElementChild : this.element;\r\n    this.divElement = this.setElementStyle(this.element, spinnerDivElement);\r\n    if (this.block) this.target.classList.add(this.config.blockerClass);\r\n\r\n    //todo check si es custom element o como para decirdir hacer eso o\r\n    //container.insertBefore(this.divElement, container.firstChild););\r\n    container.firstElementChild.appendChild(this.divElement);\r\n  }\r\n\r\n  // todo fix too recalculate element height\r\n  private setElementStyle(element: any, htmlElement: HTMLElement): HTMLElement {\r\n    element.style.position = 'relative';\r\n    htmlElement.style.position = 'absolute';\r\n    htmlElement.style.zIndex = '999';\r\n    htmlElement.style.top = 'calc(50% - 65px)';\r\n    htmlElement.style.left = 'calc(50% - 35px)';\r\n\r\n    return htmlElement;\r\n  }\r\n\r\n}\r\n"]}