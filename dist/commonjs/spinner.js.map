{"version":3,"sources":["spinner.js","../src/spinner.ts"],"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","__decorate","decorators","target","key","desc","c","r","getOwnPropertyDescriptor","d","Reflect","decorate","defineProperty","exports","value","aurelia_framework_1","require","aurelia_pal_1","spinner_config_1","SpinnerCustomAttribute","element","container","viewEngine","spinnerConfig","spinnerHtml","PLATFORM","moduleName","config","SpinnerConfig","show","view","undefined","block","freeze","bind","spinner","useBackgroundBlocker","Error","attached","createSpinner","showChanged","showSpinner","classList","add","blockerClass","remove","_this","loadViewFactory","then","factory","childContainer","createChild","create","addElement","removeSpinner","document","querySelectorAll","id","removeChild","divElement","spinnerDivElement","createElement","appendNodesTo","children","firstElementChild","setElementStyle","appendChild","htmlElement","style","position","zIndex","top","left","bindable","defaultBindingMode","bindingMode","oneWay","oneTime","inject","Element","Container","ViewEngine"],"mappings":"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","file":"spinner.js","sourceRoot":"/source/","sourcesContent":["\"use strict\";\nvar __assign = (this && this.__assign) || Object.assign || function(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n            t[p] = s[p];\n    }\n    return t;\n};\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar aurelia_framework_1 = require(\"aurelia-framework\");\nvar aurelia_pal_1 = require(\"aurelia-pal\");\nvar spinner_config_1 = require(\"./spinner-config\");\nvar SpinnerCustomAttribute = (function () {\n    function SpinnerCustomAttribute(element, container, viewEngine, spinnerConfig) {\n        this.element = element;\n        this.container = container;\n        this.viewEngine = viewEngine;\n        this.spinnerConfig = spinnerConfig;\n        this.spinnerHtml = aurelia_pal_1.PLATFORM.moduleName('aurelia-spinner/dist/spinner.html');\n        this.config = new spinner_config_1.SpinnerConfig();\n        this.show = false;\n        this.view = undefined;\n        this.block = undefined;\n        if (spinnerConfig)\n            this.config = Object.freeze(__assign({}, this.config, this.spinnerConfig));\n    }\n    SpinnerCustomAttribute.prototype.bind = function () {\n        this.view = this.view || this.config.spinner;\n        this.block = this.block === undefined ? this.config.useBackgroundBlocker : this.block;\n        if (!this.view)\n            throw new Error(\"no view has been specified for the spinner\");\n    };\n    SpinnerCustomAttribute.prototype.attached = function () {\n        this.createSpinner();\n    };\n    SpinnerCustomAttribute.prototype.showChanged = function (showSpinner) {\n        if (!this.target || !this.block)\n            return;\n        showSpinner ? this.target.classList.add(this.config.blockerClass) :\n            this.target.classList.remove(this.config.blockerClass);\n    };\n    SpinnerCustomAttribute.prototype.createSpinner = function () {\n        var _this = this;\n        this.viewEngine.loadViewFactory(this.spinnerHtml).then(function (factory) {\n            var childContainer = _this.container.createChild();\n            var view = factory.create(childContainer);\n            view.bind(_this);\n            _this.addElement(view);\n        });\n    };\n    SpinnerCustomAttribute.prototype.removeSpinner = function () {\n        var removeSpinner = document.querySelectorAll(\"#\" + this.element.id)[0];\n        removeSpinner.removeChild(this.divElement);\n    };\n    SpinnerCustomAttribute.prototype.addElement = function (view) {\n        var container = document.querySelectorAll(\"#\" + this.element.id)[0];\n        var spinnerDivElement = document.createElement('div');\n        view.appendNodesTo(spinnerDivElement);\n        this.target = this.element.children.length === 1 ? this.element.firstElementChild : this.element;\n        this.divElement = this.setElementStyle(this.element, spinnerDivElement);\n        if (this.block)\n            this.target.classList.add(this.config.blockerClass);\n        container.firstElementChild.appendChild(this.divElement);\n    };\n    SpinnerCustomAttribute.prototype.setElementStyle = function (element, htmlElement) {\n        element.style.position = 'relative';\n        htmlElement.style.position = 'absolute';\n        htmlElement.style.zIndex = '999';\n        htmlElement.style.top = 'calc(50% - 65px)';\n        htmlElement.style.left = 'calc(50% - 35px)';\n        return htmlElement;\n    };\n    __decorate([\n        aurelia_framework_1.bindable({ defaultBindingMode: aurelia_framework_1.bindingMode.oneWay })\n    ], SpinnerCustomAttribute.prototype, \"show\", void 0);\n    __decorate([\n        aurelia_framework_1.bindable({ defaultBindingMode: aurelia_framework_1.bindingMode.oneTime })\n    ], SpinnerCustomAttribute.prototype, \"view\", void 0);\n    __decorate([\n        aurelia_framework_1.bindable({ defaultBindingMode: aurelia_framework_1.bindingMode.oneTime })\n    ], SpinnerCustomAttribute.prototype, \"block\", void 0);\n    SpinnerCustomAttribute = __decorate([\n        aurelia_framework_1.inject(Element, aurelia_framework_1.Container, aurelia_framework_1.ViewEngine, 'spinner-config')\n    ], SpinnerCustomAttribute);\n    return SpinnerCustomAttribute;\n}());\nexports.SpinnerCustomAttribute = SpinnerCustomAttribute;\n","import { inject, bindable, bindingMode, Container, View, ViewEngine } from 'aurelia-framework';\r\nimport { PLATFORM } from 'aurelia-pal';\r\n\r\nimport { SpinnerConfig, spinnerViews } from \"./spinner-config\";\r\n\r\n@inject(Element, Container, ViewEngine, 'spinner-config')\r\nexport class SpinnerCustomAttribute {\r\n  private divElement: HTMLElement;\r\n  private target: Element;\r\n  private readonly spinnerHtml: string = PLATFORM.moduleName('aurelia-spinner/dist/spinner.html');\r\n  private config: SpinnerConfig = new SpinnerConfig();\r\n\r\n  @bindable({ defaultBindingMode: bindingMode.oneWay }) show: boolean = false;\r\n  @bindable({ defaultBindingMode: bindingMode.oneTime }) view: string = undefined;\r\n  @bindable({ defaultBindingMode: bindingMode.oneTime }) block: boolean = undefined;\r\n\r\n  constructor(private element: Element,\r\n    private container: Container,\r\n    private viewEngine: ViewEngine,\r\n    private spinnerConfig: SpinnerConfig) {\r\n    if (spinnerConfig) this.config = Object.freeze({ ...this.config, ...this.spinnerConfig });\r\n  }\r\n\r\n  bind() {\r\n    this.view = this.view || this.config.spinner;\r\n    this.block = this.block === undefined ? this.config.useBackgroundBlocker : this.block;\r\n\r\n    if (!this.view) throw new Error(\"no view has been specified for the spinner\");\r\n  }\r\n\r\n  attached() {\r\n    this.createSpinner();\r\n  }\r\n\r\n  showChanged(showSpinner: boolean) {\r\n    if (!this.target || !this.block) return;\r\n\r\n    showSpinner ? this.target.classList.add(this.config.blockerClass) :\r\n      this.target.classList.remove(this.config.blockerClass);\r\n  }\r\n\r\n  private createSpinner(): void {\r\n    this.viewEngine.loadViewFactory(this.spinnerHtml).then(factory => {\r\n      const childContainer: Container = this.container.createChild();\r\n      const view: View = factory.create(childContainer);\r\n      view.bind(this);\r\n\r\n      this.addElement(view);\r\n    });\r\n  }\r\n\r\n  private removeSpinner(): void {\r\n    const removeSpinner: Element = document.querySelectorAll(`#${this.element.id}`)[0];\r\n    removeSpinner.removeChild(this.divElement);\r\n  }\r\n\r\n  private addElement(view: View): void {\r\n    const container: Element = document.querySelectorAll(`#${this.element.id}`)[0];\r\n    const spinnerDivElement: HTMLElement = <HTMLElement>document.createElement('div');\r\n\r\n    view.appendNodesTo(spinnerDivElement);\r\n\r\n    this.target = this.element.children.length === 1 ? this.element.firstElementChild : this.element;\r\n    this.divElement = this.setElementStyle(this.element, spinnerDivElement);\r\n    if (this.block) this.target.classList.add(this.config.blockerClass);\r\n\r\n    container.firstElementChild.appendChild(this.divElement);\r\n  }\r\n\r\n  private setElementStyle(element: any, htmlElement: HTMLElement): HTMLElement {\r\n    element.style.position = 'relative';\r\n    htmlElement.style.position = 'absolute';\r\n    htmlElement.style.zIndex = '999';\r\n    htmlElement.style.top = 'calc(50% - 65px)';\r\n    htmlElement.style.left = 'calc(50% - 35px)';\r\n\r\n    return htmlElement;\r\n  }\r\n\r\n}\r\n"]}