{"version":3,"sources":["../src/spinner.ts"],"names":[],"mappings":"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","file":"spinner.js","sourcesContent":["import { inject, bindable, bindingMode, Container, View, ViewEngine } from 'aurelia-framework';\r\nimport { PLATFORM } from 'aurelia-pal';\r\n\r\nimport { SpinnerConfig, spinnerViews } from \"./spinner-config\";\r\n\r\n@inject(Element, Container, ViewEngine, 'spinner-config')\r\nexport class SpinnerCustomAttribute {\r\n  private divElement: HTMLElement;\r\n  private target: Element;\r\n  private readonly spinnerHtml: string = PLATFORM.moduleName('aurelia-spinner/dist/spinner.html');\r\n  private config: SpinnerConfig = new SpinnerConfig();\r\n\r\n  @bindable({ defaultBindingMode: bindingMode.oneWay }) show: boolean = false;\r\n  @bindable({ defaultBindingMode: bindingMode.oneTime }) view: string = undefined;\r\n  @bindable({ defaultBindingMode: bindingMode.oneTime }) block: boolean = undefined;\r\n\r\n  constructor(private element: Element,\r\n    private container: Container,\r\n    private viewEngine: ViewEngine,\r\n    private spinnerConfig: SpinnerConfig) {\r\n    if (spinnerConfig) this.config = Object.freeze({ ...this.config, ...this.spinnerConfig });\r\n  }\r\n\r\n  bind() {\r\n    this.view = this.view || this.config.spinner;\r\n    this.block = this.block === undefined ? this.config.useBackgroundBlocker : this.block;\r\n\r\n    if (!this.view) throw new Error(\"no view has been specified for the spinner\");\r\n  }\r\n\r\n  attached() {\r\n    this.createSpinner();\r\n  }\r\n\r\n  showChanged(showSpinner: boolean) {\r\n    if (!this.target || !this.block) return;\r\n\r\n    showSpinner ? this.target.classList.add(this.config.blockerClass) :\r\n      this.target.classList.remove(this.config.blockerClass);\r\n  }\r\n\r\n  private createSpinner(): void {\r\n    this.viewEngine.loadViewFactory(this.spinnerHtml).then(factory => {\r\n      const childContainer: Container = this.container.createChild();\r\n      const view: View = factory.create(childContainer);\r\n      view.bind(this);\r\n\r\n      this.addElement(view);\r\n    });\r\n  }\r\n\r\n  private removeSpinner(): void {\r\n    const removeSpinner: Element = document.querySelectorAll(`#${this.element.id}`)[0];\r\n    removeSpinner.removeChild(this.divElement);\r\n  }\r\n\r\n  private addElement(view: View): void {\r\n    const container: Element = document.querySelectorAll(`#${this.element.id}`)[0];\r\n    const spinnerDivElement: HTMLElement = <HTMLElement>document.createElement('div');\r\n\r\n    view.appendNodesTo(spinnerDivElement);\r\n\r\n    this.target = this.element.children.length === 1 ? this.element.firstElementChild : this.element;\r\n    this.divElement = this.setElementStyle(this.element, spinnerDivElement);\r\n    if (this.block) this.target.classList.add(this.config.blockerClass);\r\n\r\n    container.firstElementChild.appendChild(this.divElement);\r\n  }\r\n\r\n  private setElementStyle(element: any, htmlElement: HTMLElement): HTMLElement {\r\n    element.style.position = 'relative';\r\n    htmlElement.style.position = 'absolute';\r\n    htmlElement.style.zIndex = '999';\r\n    htmlElement.style.top = 'calc(50% - 65px)';\r\n    htmlElement.style.left = 'calc(50% - 35px)';\r\n\r\n    return htmlElement;\r\n  }\r\n\r\n}\r\n"],"sourceRoot":"/source/"}